<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed OS Reference: CryptoCell RSA primitive APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mbed OS Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__crys__rsa__prim.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">CryptoCell RSA primitive APIs<div class="ingroups"><a class="el" href="group__crys__rsa.html">CryptoCell RSA APIs</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaee2c7a3feededce55f9fc9524850e135"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#gaee2c7a3feededce55f9fc9524850e135">CRYS_RSA_PRIM_Sign</a>&#160;&#160;&#160;<a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e">CRYS_RSA_PRIM_Decrypt</a></td></tr>
<tr class="memdesc:gaee2c7a3feededce55f9fc9524850e135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSASP1 algorithm, as defined in [PKCS1_2.1] - 6.2.1, as a call to <a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e" title="Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2.">CRYS_RSA_PRIM_Decrypt</a>, since the signature primitive is identical to the decryption primitive.  <a href="group__crys__rsa__prim.html#gaee2c7a3feededce55f9fc9524850e135">More...</a><br /></td></tr>
<tr class="separator:gaee2c7a3feededce55f9fc9524850e135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae47765de215324bc8a8c318b8432938e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#gae47765de215324bc8a8c318b8432938e">CRYS_RSA_PRIM_Verify</a>&#160;&#160;&#160;<a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3">CRYS_RSA_PRIM_Encrypt</a></td></tr>
<tr class="memdesc:gae47765de215324bc8a8c318b8432938e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSAVP1 algorithm, as defined in [PKCS1_2.1] - 6.2.2, as a call to <a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3" title="Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1.">CRYS_RSA_PRIM_Encrypt</a>.  <a href="group__crys__rsa__prim.html#gae47765de215324bc8a8c318b8432938e">More...</a><br /></td></tr>
<tr class="separator:gae47765de215324bc8a8c318b8432938e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6525013327c2d37e40bbcb20f6fd85d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3">CRYS_RSA_PRIM_Encrypt</a> (<a class="el" href="struct_c_r_y_s___r_s_a_user_pub_key__t.html">CRYS_RSAUserPubKey_t</a> *UserPubKey_ptr, <a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *PrimeData_ptr, uint8_t *Data_ptr, uint16_t DataSize, uint8_t *Output_ptr)</td></tr>
<tr class="memdesc:ga6525013327c2d37e40bbcb20f6fd85d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1.  <a href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3">More...</a><br /></td></tr>
<tr class="separator:ga6525013327c2d37e40bbcb20f6fd85d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga602882c564790dc76b53f652af148e7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e">CRYS_RSA_PRIM_Decrypt</a> (<a class="el" href="struct_c_r_y_s___r_s_a_user_priv_key__t.html">CRYS_RSAUserPrivKey_t</a> *UserPrivKey_ptr, <a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *PrimeData_ptr, uint8_t *Data_ptr, uint16_t DataSize, uint8_t *Output_ptr)</td></tr>
<tr class="memdesc:ga602882c564790dc76b53f652af148e7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2.  <a href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e">More...</a><br /></td></tr>
<tr class="separator:ga602882c564790dc76b53f652af148e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section note"><dt>Note</dt><dd>Direct use of primitive functions, rather than schemes to protect data, is strongly discouraged as primitive functions are susceptible to well-known attacks. </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaee2c7a3feededce55f9fc9524850e135" name="gaee2c7a3feededce55f9fc9524850e135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaee2c7a3feededce55f9fc9524850e135">&#9670;&#160;</a></span>CRYS_RSA_PRIM_Sign</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYS_RSA_PRIM_Sign&#160;&#160;&#160;<a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e">CRYS_RSA_PRIM_Decrypt</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the RSASP1 algorithm, as defined in [PKCS1_2.1] - 6.2.1, as a call to <a class="el" href="group__crys__rsa__prim.html#ga602882c564790dc76b53f652af148e7e" title="Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2.">CRYS_RSA_PRIM_Decrypt</a>, since the signature primitive is identical to the decryption primitive. </p>

<p class="definition">Definition at line <a class="el" href="crys__rsa__prim_8h_source.html#l00112">112</a> of file <a class="el" href="crys__rsa__prim_8h_source.html">crys_rsa_prim.h</a>.</p>

</div>
</div>
<a id="gae47765de215324bc8a8c318b8432938e" name="gae47765de215324bc8a8c318b8432938e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae47765de215324bc8a8c318b8432938e">&#9670;&#160;</a></span>CRYS_RSA_PRIM_Verify</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYS_RSA_PRIM_Verify&#160;&#160;&#160;<a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3">CRYS_RSA_PRIM_Encrypt</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the RSAVP1 algorithm, as defined in [PKCS1_2.1] - 6.2.2, as a call to <a class="el" href="group__crys__rsa__prim.html#ga6525013327c2d37e40bbcb20f6fd85d3" title="Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1.">CRYS_RSA_PRIM_Encrypt</a>. </p>

<p class="definition">Definition at line <a class="el" href="crys__rsa__prim_8h_source.html#l00117">117</a> of file <a class="el" href="crys__rsa__prim_8h_source.html">crys_rsa_prim.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga602882c564790dc76b53f652af148e7e" name="ga602882c564790dc76b53f652af148e7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga602882c564790dc76b53f652af148e7e">&#9670;&#160;</a></span>CRYS_RSA_PRIM_Decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a> CRYS_RSA_PRIM_Decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_user_priv_key__t.html">CRYS_RSAUserPrivKey_t</a> *&#160;</td>
          <td class="paramname"><em>UserPrivKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *&#160;</td>
          <td class="paramname"><em>PrimeData_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Data_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>DataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Output_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the RSADP algorithm, as defined in [PKCS1_2.1] - 6.1.2. </p>
<dl class="section return"><dt>Returns</dt><dd>CRYS_OK on success. </dd>
<dd>
A non-zero value from <a class="el" href="crys__rsa__error_8h.html" title="This module contains the definitions of the CRYS RSA errors.">crys_rsa_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UserPrivKey_ptr</td><td>Pointer to the private key data structure. The key representation (pair or quintuple) and hence the RSA algorithm (CRT or not-CRT) is determined by enum value in the structure <a class="el" href="group__crys__rsa__build.html#gabdadf6d31aa61300edc1e9a3e1045c0e" title="Builds a CRYSRSAPrivKey_t private key structure with the provided modulus and exponent,...">CRYS_RSA_Build_PrivKey</a> or <a class="el" href="group__crys__rsa__build.html#ga08e98a8d11c546c99cbe82af1e9f151a" title="Builds a CRYSRSAPrivKey_t private key structure with the provided parameters, marking the key as a CR...">CRYS_RSA_Build_PrivKeyCRT</a>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PrimeData_ptr</td><td>Pointer to a temporary structure containing internal buffers required for the RSA operation.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data_ptr</td><td>Pointer to the data to be decrypted.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size (in bytes) of input data must be &le; modulus size. If the size is smaller (not recommendet), then the data will be zero-padded by the function on left side up to the modulus size and therefore, after further decrypt operation,its result will contain zero-padding also. If the function is used for recovering the plain data from result of inverse function (CRYS_RSA_PRIM_Encrypt), the input size must be equal to modulus size exactly.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Output_ptr</td><td>Pointer to the decrypted data. The buffer size must be &le; the modulus size. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6525013327c2d37e40bbcb20f6fd85d3" name="ga6525013327c2d37e40bbcb20f6fd85d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6525013327c2d37e40bbcb20f6fd85d3">&#9670;&#160;</a></span>CRYS_RSA_PRIM_Encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__crys__error.html#gaee257163cb36752ce395c0014fd97d59">CRYSError_t</a> CRYS_RSA_PRIM_Encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_user_pub_key__t.html">CRYS_RSAUserPubKey_t</a> *&#160;</td>
          <td class="paramname"><em>UserPubKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_s___r_s_a_prime_data__t.html">CRYS_RSAPrimeData_t</a> *&#160;</td>
          <td class="paramname"><em>PrimeData_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Data_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>DataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>Output_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the RSAEP algorithm, as defined in [PKCS1_2.1] - 6.1.1. </p>
<dl class="section return"><dt>Returns</dt><dd>CRYS_OK on success. </dd>
<dd>
A non-zero value from <a class="el" href="crys__rsa__error_8h.html" title="This module contains the definitions of the CRYS RSA errors.">crys_rsa_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UserPubKey_ptr</td><td>Pointer to the public key data structure.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PrimeData_ptr</td><td>Pointer to a temporary structure containing internal buffers.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data_ptr</td><td>Pointer to the data to encrypt.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>The size (in bytes) of input data must be &le; modulus size. If is smaller, then the function padds it by zeros on left side up to the modulus size and therefore, after further decrypt operation, its result will contain zero-padding also. If the function is used for recovering the plain data from result of inverse function (CRYS_RSA_PRIM_Decrypt), the input size must be equal to modulus size exactly.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Output_ptr</td><td>Pointer to the encrypted data. The buffer size must be &ge; the modulus size. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
