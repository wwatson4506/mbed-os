<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed OS Reference: Elliptic Curve Diffie-Hellman</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mbed-ce_55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">Mbed OS Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__mbedtls__ecdh__module.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Elliptic Curve Diffie-Hellman<div class="ingroups"><a class="el" href="group__mbed-os-public.html">Public API</a> &raquo; <a class="el" href="group__public-crypto.html">Cryptography</a> &raquo; <a class="el" href="group__mbedtls.html">Mbed TLS</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ecdh__context__mbed.html">mbedtls_ecdh_context_mbed</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The context used by the default ECDH implementation.  <a href="structmbedtls__ecdh__context__mbed.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ECDH context structure.  <a href="structmbedtls__ecdh__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gad99780d37a37e353f51c21bf5119fa1f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmbedtls__ecdh__context__mbed.html">mbedtls_ecdh_context_mbed</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#gad99780d37a37e353f51c21bf5119fa1f">mbedtls_ecdh_context_mbed</a></td></tr>
<tr class="memdesc:gad99780d37a37e353f51c21bf5119fa1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The context used by the default ECDH implementation.  <a href="group__mbedtls__ecdh__module.html#gad99780d37a37e353f51c21bf5119fa1f">More...</a><br /></td></tr>
<tr class="separator:gad99780d37a37e353f51c21bf5119fa1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbeab18d635fc3d2ae9afb941d41f4da"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#gabbeab18d635fc3d2ae9afb941d41f4da">mbedtls_ecdh_context</a></td></tr>
<tr class="memdesc:gabbeab18d635fc3d2ae9afb941d41f4da"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ECDH context structure.  <a href="group__mbedtls__ecdh__module.html#gabbeab18d635fc3d2ae9afb941d41f4da">More...</a><br /></td></tr>
<tr class="separator:gabbeab18d635fc3d2ae9afb941d41f4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gae5df12f2068df09a102e05e02fb1e39c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#gae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> { <a class="el" href="group__mbedtls__ecdh__module.html#ggae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703">MBEDTLS_ECDH_OURS</a>
, <a class="el" href="group__mbedtls__ecdh__module.html#ggae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb">MBEDTLS_ECDH_THEIRS</a>
 }</td></tr>
<tr class="memdesc:gae5df12f2068df09a102e05e02fb1e39c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the source of the imported EC key.  <a href="group__mbedtls__ecdh__module.html#gae5df12f2068df09a102e05e02fb1e39c">More...</a><br /></td></tr>
<tr class="separator:gae5df12f2068df09a102e05e02fb1e39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c17082db89e58cce0bf0731a02a20f6"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga3c17082db89e58cce0bf0731a02a20f6">mbedtls_ecdh_variant</a> { <a class="el" href="group__mbedtls__ecdh__module.html#gga3c17082db89e58cce0bf0731a02a20f6a732474bdbaa76dad2641c0ff4c7567bc">MBEDTLS_ECDH_VARIANT_NONE</a> = 0
, <a class="el" href="group__mbedtls__ecdh__module.html#gga3c17082db89e58cce0bf0731a02a20f6a5f32618aebf8b95a9d35640a60dd8885">MBEDTLS_ECDH_VARIANT_MBEDTLS_2_0</a>
 }</td></tr>
<tr class="memdesc:ga3c17082db89e58cce0bf0731a02a20f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the ECDH implementation used.  <a href="group__mbedtls__ecdh__module.html#ga3c17082db89e58cce0bf0731a02a20f6">More...</a><br /></td></tr>
<tr class="separator:ga3c17082db89e58cce0bf0731a02a20f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7601b043149f7171a47248b7244a4857"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga7601b043149f7171a47248b7244a4857">mbedtls_ecdh_can_do</a> (<a class="el" href="group__mbedtls__ecp__module.html#gaf79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a> gid)</td></tr>
<tr class="memdesc:ga7601b043149f7171a47248b7244a4857"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a given group can be used for ECDH.  <a href="group__mbedtls__ecdh__module.html#ga7601b043149f7171a47248b7244a4857">More...</a><br /></td></tr>
<tr class="separator:ga7601b043149f7171a47248b7244a4857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga403a5d7363b6219a2017b837b665c354"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga403a5d7363b6219a2017b837b665c354">mbedtls_ecdh_gen_public</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:ga403a5d7363b6219a2017b837b665c354"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates an ECDH keypair on an elliptic curve.  <a href="group__mbedtls__ecdh__module.html#ga403a5d7363b6219a2017b837b665c354">More...</a><br /></td></tr>
<tr class="separator:ga403a5d7363b6219a2017b837b665c354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca0670e79f3002a218d6da8c8dee61e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#gaca0670e79f3002a218d6da8c8dee61e1">mbedtls_ecdh_compute_shared</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *z, const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:gaca0670e79f3002a218d6da8c8dee61e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the shared secret.  <a href="group__mbedtls__ecdh__module.html#gaca0670e79f3002a218d6da8c8dee61e1">More...</a><br /></td></tr>
<tr class="separator:gaca0670e79f3002a218d6da8c8dee61e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97e787a12f7aae180ab9828303199dca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga97e787a12f7aae180ab9828303199dca">mbedtls_ecdh_init</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:ga97e787a12f7aae180ab9828303199dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an ECDH context.  <a href="group__mbedtls__ecdh__module.html#ga97e787a12f7aae180ab9828303199dca">More...</a><br /></td></tr>
<tr class="separator:ga97e787a12f7aae180ab9828303199dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga296f6ce7b1b8b53d048a6c28ff3420cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga296f6ce7b1b8b53d048a6c28ff3420cc">mbedtls_ecdh_setup</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, <a class="el" href="group__mbedtls__ecp__module.html#gaf79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a> grp_id)</td></tr>
<tr class="memdesc:ga296f6ce7b1b8b53d048a6c28ff3420cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets up the ECDH context with the information given.  <a href="group__mbedtls__ecdh__module.html#ga296f6ce7b1b8b53d048a6c28ff3420cc">More...</a><br /></td></tr>
<tr class="separator:ga296f6ce7b1b8b53d048a6c28ff3420cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga89cc40dc92fbbaf0275ea9a6184a5e71">mbedtls_ecdh_free</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx)</td></tr>
<tr class="memdesc:ga89cc40dc92fbbaf0275ea9a6184a5e71"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function frees a context.  <a href="group__mbedtls__ecdh__module.html#ga89cc40dc92fbbaf0275ea9a6184a5e71">More...</a><br /></td></tr>
<tr class="separator:ga89cc40dc92fbbaf0275ea9a6184a5e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga784e56d5eea12e38374e9ce028692940"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga784e56d5eea12e38374e9ce028692940">mbedtls_ecdh_make_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:ga784e56d5eea12e38374e9ce028692940"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange handshake message.  <a href="group__mbedtls__ecdh__module.html#ga784e56d5eea12e38374e9ce028692940">More...</a><br /></td></tr>
<tr class="separator:ga784e56d5eea12e38374e9ce028692940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf07326ad0017bf6fcfb9f93e43641254"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#gaf07326ad0017bf6fcfb9f93e43641254">mbedtls_ecdh_read_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char **buf, const unsigned char *end)</td></tr>
<tr class="memdesc:gaf07326ad0017bf6fcfb9f93e43641254"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.  <a href="group__mbedtls__ecdh__module.html#gaf07326ad0017bf6fcfb9f93e43641254">More...</a><br /></td></tr>
<tr class="separator:gaf07326ad0017bf6fcfb9f93e43641254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c03b82213c39abd90a5bd4b1646441d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga3c03b82213c39abd90a5bd4b1646441d">mbedtls_ecdh_get_params</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *key, <a class="el" href="group__mbedtls__ecdh__module.html#gae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a> side)</td></tr>
<tr class="memdesc:ga3c03b82213c39abd90a5bd4b1646441d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets up an ECDH context from an EC key.  <a href="group__mbedtls__ecdh__module.html#ga3c03b82213c39abd90a5bd4b1646441d">More...</a><br /></td></tr>
<tr class="separator:ga3c03b82213c39abd90a5bd4b1646441d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga417fd45ce78adb1b52027f995fa5ee57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga417fd45ce78adb1b52027f995fa5ee57">mbedtls_ecdh_make_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:ga417fd45ce78adb1b52027f995fa5ee57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates a public key and exports it as a TLS ClientKeyExchange payload.  <a href="group__mbedtls__ecdh__module.html#ga417fd45ce78adb1b52027f995fa5ee57">More...</a><br /></td></tr>
<tr class="separator:ga417fd45ce78adb1b52027f995fa5ee57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f417d90797b109d3036feb288e33207"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga9f417d90797b109d3036feb288e33207">mbedtls_ecdh_read_public</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, const unsigned char *buf, size_t blen)</td></tr>
<tr class="memdesc:ga9f417d90797b109d3036feb288e33207"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function parses and processes the ECDHE payload of a TLS ClientKeyExchange message.  <a href="group__mbedtls__ecdh__module.html#ga9f417d90797b109d3036feb288e33207">More...</a><br /></td></tr>
<tr class="separator:ga9f417d90797b109d3036feb288e33207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga423fee27a0c8603bba336cbfe6dadcaa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbedtls__ecdh__module.html#ga423fee27a0c8603bba336cbfe6dadcaa">mbedtls_ecdh_calc_secret</a> (<a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *ctx, size_t *olen, unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:ga423fee27a0c8603bba336cbfe6dadcaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function derives and exports the shared secret.  <a href="group__mbedtls__ecdh__module.html#ga423fee27a0c8603bba336cbfe6dadcaa">More...</a><br /></td></tr>
<tr class="separator:ga423fee27a0c8603bba336cbfe6dadcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gad99780d37a37e353f51c21bf5119fa1f" name="gad99780d37a37e353f51c21bf5119fa1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad99780d37a37e353f51c21bf5119fa1f">&#9670;&#160;</a></span>mbedtls_ecdh_context_mbed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmbedtls__ecdh__context__mbed.html">mbedtls_ecdh_context_mbed</a> <a class="el" href="structmbedtls__ecdh__context__mbed.html">mbedtls_ecdh_context_mbed</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The context used by the default ECDH implementation. </p>
<p >Later versions might change the structure of this context, therefore users should not make any assumptions about the structure of <a class="el" href="structmbedtls__ecdh__context__mbed.html" title="The context used by the default ECDH implementation.">mbedtls_ecdh_context_mbed</a>. </p>

</div>
</div>
<a id="gabbeab18d635fc3d2ae9afb941d41f4da" name="gabbeab18d635fc3d2ae9afb941d41f4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabbeab18d635fc3d2ae9afb941d41f4da">&#9670;&#160;</a></span>mbedtls_ecdh_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> <a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ECDH context structure. </p>
<dl class="section warning"><dt>Warning</dt><dd>Performing multiple operations concurrently on the same ECDSA context is not supported; objects of this type should not be shared between multiple threads. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gae5df12f2068df09a102e05e02fb1e39c" name="gae5df12f2068df09a102e05e02fb1e39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5df12f2068df09a102e05e02fb1e39c">&#9670;&#160;</a></span>mbedtls_ecdh_side</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__mbedtls__ecdh__module.html#gae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the source of the imported EC key. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703" name="ggae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703"></a>MBEDTLS_ECDH_OURS&#160;</td><td class="fielddoc"><p >Our key. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb" name="ggae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb"></a>MBEDTLS_ECDH_THEIRS&#160;</td><td class="fielddoc"><p >The key of the peer. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ecdh_8h_source.html#l00063">63</a> of file <a class="el" href="ecdh_8h_source.html">ecdh.h</a>.</p>

</div>
</div>
<a id="ga3c17082db89e58cce0bf0731a02a20f6" name="ga3c17082db89e58cce0bf0731a02a20f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3c17082db89e58cce0bf0731a02a20f6">&#9670;&#160;</a></span>mbedtls_ecdh_variant</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__mbedtls__ecdh__module.html#ga3c17082db89e58cce0bf0731a02a20f6">mbedtls_ecdh_variant</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the ECDH implementation used. </p>
<p >Later versions of the library may add new variants, therefore users should not make any assumptions about them. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga3c17082db89e58cce0bf0731a02a20f6a732474bdbaa76dad2641c0ff4c7567bc" name="gga3c17082db89e58cce0bf0731a02a20f6a732474bdbaa76dad2641c0ff4c7567bc"></a>MBEDTLS_ECDH_VARIANT_NONE&#160;</td><td class="fielddoc"><p >Implementation not defined. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga3c17082db89e58cce0bf0731a02a20f6a5f32618aebf8b95a9d35640a60dd8885" name="gga3c17082db89e58cce0bf0731a02a20f6a5f32618aebf8b95a9d35640a60dd8885"></a>MBEDTLS_ECDH_VARIANT_MBEDTLS_2_0&#160;</td><td class="fielddoc"><p >The default Mbed TLS implementation </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ecdh_8h_source.html#l00076">76</a> of file <a class="el" href="ecdh_8h_source.html">ecdh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga7601b043149f7171a47248b7244a4857" name="ga7601b043149f7171a47248b7244a4857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7601b043149f7171a47248b7244a4857">&#9670;&#160;</a></span>mbedtls_ecdh_can_do()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_can_do </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__mbedtls__ecp__module.html#gaf79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a>&#160;</td>
          <td class="paramname"><em>gid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether a given group can be used for ECDH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gid</td><td>The ECP group ID to check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>1</code> if the group can be used, <code>0</code> otherwise </dd></dl>

</div>
</div>
<a id="ga403a5d7363b6219a2017b837b665c354" name="ga403a5d7363b6219a2017b837b665c354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga403a5d7363b6219a2017b837b665c354">&#9670;&#160;</a></span>mbedtls_ecdh_gen_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_gen_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates an ECDH keypair on an elliptic curve. </p>
<p >This function performs the first of two core computations implemented during the ECDH key exchange. The second core computation is performed by <a class="el" href="group__mbedtls__ecdh__module.html#gaca0670e79f3002a218d6da8c8dee61e1" title="This function computes the shared secret.">mbedtls_ecdh_compute_shared()</a>.</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>The ECP group to use. This must be initialized and have domain parameters loaded, for example through mbedtls_ecp_load() or <a class="el" href="group__mbedtls__ecp__module.html#gacfd0cdb926358713b31c48b2e4dd9e58" title="This function sets up an ECP group context from a TLS ECParameters record as defined in RFC 4492,...">mbedtls_ecp_tls_read_group()</a>. </td></tr>
    <tr><td class="paramname">d</td><td>The destination MPI (private key). This must be initialized. </td></tr>
    <tr><td class="paramname">Q</td><td>The destination point (public key). This must be initialized. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> in case <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> or <code>MBEDTLS_MPI_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="gaca0670e79f3002a218d6da8c8dee61e1" name="gaca0670e79f3002a218d6da8c8dee61e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca0670e79f3002a218d6da8c8dee61e1">&#9670;&#160;</a></span>mbedtls_ecdh_compute_shared()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_compute_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the shared secret. </p>
<pre class="fragment">             This function performs the second of two core computations
             implemented during the ECDH key exchange. The first core
             computation is performed by mbedtls_ecdh_gen_public().
</pre> <dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If <code>f_rng</code> is not NULL, it is used to implement countermeasures against side-channel attacks. For more information, see <a class="el" href="group__mbedtls__ecp__module.html#ga4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>The ECP group to use. This must be initialized and have domain parameters loaded, for example through mbedtls_ecp_load() or <a class="el" href="group__mbedtls__ecp__module.html#gacfd0cdb926358713b31c48b2e4dd9e58" title="This function sets up an ECP group context from a TLS ECParameters record as defined in RFC 4492,...">mbedtls_ecp_tls_read_group()</a>. </td></tr>
    <tr><td class="paramname">z</td><td>The destination MPI (shared secret). This must be initialized. </td></tr>
    <tr><td class="paramname">Q</td><td>The public key from another party. This must be initialized. </td></tr>
    <tr><td class="paramname">d</td><td>Our secret exponent (private key). This must be initialized. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function. This may be <code>NULL</code> if randomization of intermediate results during the ECP computations is not needed (discouraged). See the documentation of <a class="el" href="group__mbedtls__ecp__module.html#ga4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a> for more. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> if <code>f_rng</code> is <code>NULL</code> or doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> or <code>MBEDTLS_MPI_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="ga97e787a12f7aae180ab9828303199dca" name="ga97e787a12f7aae180ab9828303199dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga97e787a12f7aae180ab9828303199dca">&#9670;&#160;</a></span>mbedtls_ecdh_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes an ECDH context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to initialize. This must not be <code>NULL</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga296f6ce7b1b8b53d048a6c28ff3420cc" name="ga296f6ce7b1b8b53d048a6c28ff3420cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga296f6ce7b1b8b53d048a6c28ff3420cc">&#9670;&#160;</a></span>mbedtls_ecdh_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mbedtls__ecp__module.html#gaf79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a>&#160;</td>
          <td class="paramname"><em>grp_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets up the ECDH context with the information given. </p>
<p >This function should be called after <a class="el" href="group__mbedtls__ecdh__module.html#ga97e787a12f7aae180ab9828303199dca" title="This function initializes an ECDH context.">mbedtls_ecdh_init()</a> but before <a class="el" href="group__mbedtls__ecdh__module.html#ga784e56d5eea12e38374e9ce028692940" title="This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange ...">mbedtls_ecdh_make_params()</a>. There is no need to call this function before <a class="el" href="group__mbedtls__ecdh__module.html#gaf07326ad0017bf6fcfb9f93e43641254" title="This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.">mbedtls_ecdh_read_params()</a>.</p>
<p >This is the first function used by a TLS server for ECDHE ciphersuites.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to set up. This must be initialized. </td></tr>
    <tr><td class="paramname">grp_id</td><td>The group id of the group to set up the context for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd></dl>

</div>
</div>
<a id="ga89cc40dc92fbbaf0275ea9a6184a5e71" name="ga89cc40dc92fbbaf0275ea9a6184a5e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89cc40dc92fbbaf0275ea9a6184a5e71">&#9670;&#160;</a></span>mbedtls_ecdh_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdh_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function frees a context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The context to free. This may be <code>NULL</code>, in which case this function does nothing. If it is not <code>NULL</code>, it must point to an initialized ECDH context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga784e56d5eea12e38374e9ce028692940" name="ga784e56d5eea12e38374e9ce028692940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga784e56d5eea12e38374e9ce028692940">&#9670;&#160;</a></span>mbedtls_ecdh_make_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange handshake message. </p>
<p >This is the second function used by a TLS server for ECDHE ciphersuites. (It is called after <a class="el" href="group__mbedtls__ecdh__module.html#ga296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>.)</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, for example via <a class="el" href="group__mbedtls__ecdh__module.html#ga296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the number of Bytes written. </td></tr>
    <tr><td class="paramname">buf</td><td>The destination buffer. This must be a writable buffer of length <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the destination buffer <code>buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> in case <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="group__mbedtls__ecp__module.html#ga6d549348fe93c843c19bfcd102b6e94f" title="Operation in progress, call again with the same parameters to continue.">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="gaf07326ad0017bf6fcfb9f93e43641254" name="gaf07326ad0017bf6fcfb9f93e43641254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf07326ad0017bf6fcfb9f93e43641254">&#9670;&#160;</a></span>mbedtls_ecdh_read_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message. </p>
<dl class="section note"><dt>Note</dt><dd>In a TLS handshake, this is the how the client sets up its ECDHE context from the server's public ECDHE key material.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDHE context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">buf</td><td>On input, <code>*buf</code> must be the start of the input buffer. On output, <code>*buf</code> is updated to point to the end of the data that has been read. On success, this is the first byte past the end of the ServerKeyExchange parameters. On error, this is the point at which an error has been detected, which is usually not useful except to debug failures. </td></tr>
    <tr><td class="paramname">end</td><td>The end of the input buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
An <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="ga3c03b82213c39abd90a5bd4b1646441d" name="ga3c03b82213c39abd90a5bd4b1646441d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3c03b82213c39abd90a5bd4b1646441d">&#9670;&#160;</a></span>mbedtls_ecdh_get_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_get_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mbedtls__ecdh__module.html#gae5df12f2068df09a102e05e02fb1e39c">mbedtls_ecdh_side</a>&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets up an ECDH context from an EC key. </p>
<pre class="fragment">             It is used by clients and servers in place of the
             ServerKeyEchange for static ECDH, and imports ECDH
             parameters from the EC key information of a certificate.
</pre> <dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to set up. This must be initialized. </td></tr>
    <tr><td class="paramname">key</td><td>The EC key to use. This must be initialized. </td></tr>
    <tr><td class="paramname">side</td><td>Defines the source of the key. Possible values are:<ul>
<li><a class="el" href="group__mbedtls__ecdh__module.html#ggae5df12f2068df09a102e05e02fb1e39ca28e1b43484f53d02de24809228780703" title="Our key.">MBEDTLS_ECDH_OURS</a>: The key is ours.</li>
<li><a class="el" href="group__mbedtls__ecdh__module.html#ggae5df12f2068df09a102e05e02fb1e39caee83a43a270657fc7dc2f26c91d2addb" title="The key of the peer.">MBEDTLS_ECDH_THEIRS</a>: The key is that of the peer.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="ga417fd45ce78adb1b52027f995fa5ee57" name="ga417fd45ce78adb1b52027f995fa5ee57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga417fd45ce78adb1b52027f995fa5ee57">&#9670;&#160;</a></span>mbedtls_ecdh_make_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_make_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates a public key and exports it as a TLS ClientKeyExchange payload. </p>
<p >This is the second function used by a TLS client for ECDH(E) ciphersuites.</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, the latter usually by <a class="el" href="group__mbedtls__ecdh__module.html#gaf07326ad0017bf6fcfb9f93e43641254" title="This function parses the ECDHE parameters in a TLS ServerKeyExchange handshake message.">mbedtls_ecdh_read_params()</a>. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the number of Bytes written. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The destination buffer. This must be a writable buffer of length <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The size of the destination buffer <code>buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function to use. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context to be passed to <code>f_rng</code>. This may be <code>NULL</code> in case <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="group__mbedtls__ecp__module.html#ga6d549348fe93c843c19bfcd102b6e94f" title="Operation in progress, call again with the same parameters to continue.">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="ga9f417d90797b109d3036feb288e33207" name="ga9f417d90797b109d3036feb288e33207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f417d90797b109d3036feb288e33207">&#9670;&#160;</a></span>mbedtls_ecdh_read_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_read_public </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function parses and processes the ECDHE payload of a TLS ClientKeyExchange message. </p>
<p >This is the third function used by a TLS server for ECDH(E) ciphersuites. (It is called after <a class="el" href="group__mbedtls__ecdh__module.html#ga296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a> and <a class="el" href="group__mbedtls__ecdh__module.html#ga784e56d5eea12e38374e9ce028692940" title="This function generates an EC key pair and exports its in the format used in a TLS ServerKeyExchange ...">mbedtls_ecdh_make_params()</a>.)</p>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and bound to a group, for example via <a class="el" href="group__mbedtls__ecdh__module.html#ga296f6ce7b1b8b53d048a6c28ff3420cc" title="This function sets up the ECDH context with the information given.">mbedtls_ecdh_setup()</a>. </td></tr>
    <tr><td class="paramname">buf</td><td>The pointer to the ClientKeyExchange payload. This must be a readable buffer of length <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the input buffer <code>buf</code> in Bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
An <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
<a id="ga423fee27a0c8603bba336cbfe6dadcaa" name="ga423fee27a0c8603bba336cbfe6dadcaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga423fee27a0c8603bba336cbfe6dadcaa">&#9670;&#160;</a></span>mbedtls_ecdh_calc_secret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdh_calc_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecdh__context.html">mbedtls_ecdh_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function derives and exports the shared secret. </p>
<pre class="fragment">             This is the last function used by both TLS client
             and servers.
</pre> <dl class="section note"><dt>Note</dt><dd>If <code>f_rng</code> is not NULL, it is used to implement countermeasures against side-channel attacks. For more information, see <a class="el" href="group__mbedtls__ecp__module.html#ga4d005045c302e100c78bdc587e8f0e6a" title="This function performs a scalar multiplication of a point by an integer: R = m * P.">mbedtls_ecp_mul()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>ecp.h</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ECDH context to use. This must be initialized and have its own private key generated and the peer's public key imported. </td></tr>
    <tr><td class="paramname">olen</td><td>The address at which to store the total number of Bytes written on success. This must not be <code>NULL</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The buffer to write the generated shared key to. This must be a writable buffer of size <code>blen</code> Bytes. </td></tr>
    <tr><td class="paramname">blen</td><td>The length of the destination buffer <code>buf</code> in Bytes. </td></tr>
    <tr><td class="paramname">f_rng</td><td>The RNG function, for blinding purposes. This may b <code>NULL</code> if blinding isn't needed. </td></tr>
    <tr><td class="paramname">p_rng</td><td>The RNG context. This may be <code>NULL</code> if <code>f_rng</code> doesn't need a context argument.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="group__mbedtls__ecp__module.html#ga6d549348fe93c843c19bfcd102b6e94f" title="Operation in progress, call again with the same parameters to continue.">MBEDTLS_ERR_ECP_IN_PROGRESS</a> if maximum number of operations was reached: see <code>mbedtls_ecp_set_max_ops()</code>. </dd>
<dd>
Another <code>MBEDTLS_ERR_ECP_XXX</code> error code on failure. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
