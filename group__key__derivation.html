<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed OS Reference: Key derivation and pseudorandom generation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mbed-ce_55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">Mbed OS Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__key__derivation.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Key derivation and pseudorandom generation<div class="ingroups"><a class="el" href="group__mbed-os-experimental.html">Experimental APIs</a> &raquo; <a class="el" href="group__experimental-crypto.html">Cryptography</a> &raquo; <a class="el" href="group__experimental-crypto-psa.html">Arm Platform Security Architecture (PSA)</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga5bdec40d201551558579a635520ae85d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga5bdec40d201551558579a635520ae85d">PSA_KEY_DERIVATION_OPERATION_INIT</a>&#160;&#160;&#160;{0, 0, 0, {0}}</td></tr>
<tr class="memdesc:ga5bdec40d201551558579a635520ae85d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This macro returns a suitable initializer for a key derivation operation object of type <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609" title="The type of the state data structure for key derivation operations.">psa_key_derivation_operation_t</a>.  <a href="group__key__derivation.html#ga5bdec40d201551558579a635520ae85d">More...</a><br /></td></tr>
<tr class="separator:ga5bdec40d201551558579a635520ae85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf80e7d71949ec72039c163b33cc2154d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#gaf80e7d71949ec72039c163b33cc2154d">PSA_KEY_DERIVATION_UNLIMITED_CAPACITY</a>&#160;&#160;&#160;((size_t)(-1))</td></tr>
<tr class="memdesc:gaf80e7d71949ec72039c163b33cc2154d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the maximum possible capacity for a key derivation operation.  <a href="group__key__derivation.html#gaf80e7d71949ec72039c163b33cc2154d">More...</a><br /></td></tr>
<tr class="separator:gaf80e7d71949ec72039c163b33cc2154d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga5f099b63799a0959c3d46718c86c2609"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structpsa__key__derivation__s.html">psa_key_derivation_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a></td></tr>
<tr class="memdesc:ga5f099b63799a0959c3d46718c86c2609"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the state data structure for key derivation operations.  <a href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">More...</a><br /></td></tr>
<tr class="separator:ga5f099b63799a0959c3d46718c86c2609"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac0b6a76e45cceb1862752bf041701859"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859">psa_key_derivation_setup</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, <a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg)</td></tr>
<tr class="memdesc:gac0b6a76e45cceb1862752bf041701859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a key derivation operation.  <a href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859">More...</a><br /></td></tr>
<tr class="separator:gac0b6a76e45cceb1862752bf041701859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b0b6769491b25e0592fce0f1c96f842"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga9b0b6769491b25e0592fce0f1c96f842">psa_key_derivation_get_capacity</a> (const <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, size_t *capacity)</td></tr>
<tr class="memdesc:ga9b0b6769491b25e0592fce0f1c96f842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the current capacity of a key derivation operation.  <a href="group__key__derivation.html#ga9b0b6769491b25e0592fce0f1c96f842">More...</a><br /></td></tr>
<tr class="separator:ga9b0b6769491b25e0592fce0f1c96f842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c26178dc8e4581cb9fbce5650db3279"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga8c26178dc8e4581cb9fbce5650db3279">psa_key_derivation_set_capacity</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, size_t capacity)</td></tr>
<tr class="memdesc:ga8c26178dc8e4581cb9fbce5650db3279"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum capacity of a key derivation operation.  <a href="group__key__derivation.html#ga8c26178dc8e4581cb9fbce5650db3279">More...</a><br /></td></tr>
<tr class="separator:ga8c26178dc8e4581cb9fbce5650db3279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8fd934dfb0ca45cbf89542ef2a5494c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga8fd934dfb0ca45cbf89542ef2a5494c2">psa_key_derivation_input_bytes</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, <a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, const uint8_t *data, size_t data_length)</td></tr>
<tr class="memdesc:ga8fd934dfb0ca45cbf89542ef2a5494c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide an input for key derivation or key agreement.  <a href="group__key__derivation.html#ga8fd934dfb0ca45cbf89542ef2a5494c2">More...</a><br /></td></tr>
<tr class="separator:ga8fd934dfb0ca45cbf89542ef2a5494c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab2d7ce8705dd8e4a093f4b8a21a0c15a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#gab2d7ce8705dd8e4a093f4b8a21a0c15a">psa_key_derivation_input_key</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, <a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, <a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> key)</td></tr>
<tr class="memdesc:gab2d7ce8705dd8e4a093f4b8a21a0c15a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide an input for key derivation in the form of a key.  <a href="group__key__derivation.html#gab2d7ce8705dd8e4a093f4b8a21a0c15a">More...</a><br /></td></tr>
<tr class="separator:gab2d7ce8705dd8e4a093f4b8a21a0c15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2cd5a8ac906747d3204ec442db78745f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga2cd5a8ac906747d3204ec442db78745f">psa_key_derivation_key_agreement</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, <a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a> step, <a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> private_key, const uint8_t *peer_key, size_t peer_key_length)</td></tr>
<tr class="memdesc:ga2cd5a8ac906747d3204ec442db78745f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a key agreement and use the shared secret as input to a key derivation.  <a href="group__key__derivation.html#ga2cd5a8ac906747d3204ec442db78745f">More...</a><br /></td></tr>
<tr class="separator:ga2cd5a8ac906747d3204ec442db78745f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06b7eb34a2fa88965f68e3d023fa12b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga06b7eb34a2fa88965f68e3d023fa12b9">psa_key_derivation_output_bytes</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, uint8_t *output, size_t output_length)</td></tr>
<tr class="memdesc:ga06b7eb34a2fa88965f68e3d023fa12b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read some data from a key derivation operation.  <a href="group__key__derivation.html#ga06b7eb34a2fa88965f68e3d023fa12b9">More...</a><br /></td></tr>
<tr class="separator:ga06b7eb34a2fa88965f68e3d023fa12b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada7a6e17222ea9e7a6be6864a00316e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#gada7a6e17222ea9e7a6be6864a00316e1">psa_key_derivation_output_key</a> (const <a class="el" href="group__attributes.html#ga0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation, <a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> *key)</td></tr>
<tr class="memdesc:gada7a6e17222ea9e7a6be6864a00316e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derive a key from an ongoing key derivation operation.  <a href="group__key__derivation.html#gada7a6e17222ea9e7a6be6864a00316e1">More...</a><br /></td></tr>
<tr class="separator:gada7a6e17222ea9e7a6be6864a00316e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90fdd2716124d0bd258826184824675f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f">psa_key_derivation_abort</a> (<a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *operation)</td></tr>
<tr class="memdesc:ga90fdd2716124d0bd258826184824675f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort a key derivation operation.  <a href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f">More...</a><br /></td></tr>
<tr class="separator:ga90fdd2716124d0bd258826184824675f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga165dda1ad80a10730cb538069d4cc7aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__key__derivation.html#ga165dda1ad80a10730cb538069d4cc7aa">psa_raw_key_agreement</a> (<a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg, <a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> private_key, const uint8_t *peer_key, size_t peer_key_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:ga165dda1ad80a10730cb538069d4cc7aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a key agreement and return the raw shared secret.  <a href="group__key__derivation.html#ga165dda1ad80a10730cb538069d4cc7aa">More...</a><br /></td></tr>
<tr class="separator:ga165dda1ad80a10730cb538069d4cc7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga5bdec40d201551558579a635520ae85d" name="ga5bdec40d201551558579a635520ae85d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5bdec40d201551558579a635520ae85d">&#9670;&#160;</a></span>PSA_KEY_DERIVATION_OPERATION_INIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSA_KEY_DERIVATION_OPERATION_INIT&#160;&#160;&#160;{0, 0, 0, {0}}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This macro returns a suitable initializer for a key derivation operation object of type <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609" title="The type of the state data structure for key derivation operations.">psa_key_derivation_operation_t</a>. </p>

<p class="definition">Definition at line <a class="el" href="crypto__struct_8h_source.html#l00282">282</a> of file <a class="el" href="crypto__struct_8h_source.html">crypto_struct.h</a>.</p>

</div>
</div>
<a id="gaf80e7d71949ec72039c163b33cc2154d" name="gaf80e7d71949ec72039c163b33cc2154d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf80e7d71949ec72039c163b33cc2154d">&#9670;&#160;</a></span>PSA_KEY_DERIVATION_UNLIMITED_CAPACITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSA_KEY_DERIVATION_UNLIMITED_CAPACITY&#160;&#160;&#160;((size_t)(-1))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use the maximum possible capacity for a key derivation operation. </p>
<p >Use this value as the capacity argument when setting up a key derivation to indicate that the operation should have the maximum possible capacity. The value of the maximum possible capacity depends on the key derivation algorithm. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l03184">3184</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga5f099b63799a0959c3d46718c86c2609" name="ga5f099b63799a0959c3d46718c86c2609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f099b63799a0959c3d46718c86c2609">&#9670;&#160;</a></span>psa_key_derivation_operation_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structpsa__key__derivation__s.html">psa_key_derivation_s</a> <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The type of the state data structure for key derivation operations. </p>
<p >Before calling any function on a key derivation operation object, the application must initialize it by any of the following means:</p><ul>
<li>Set the structure to all-bits-zero, for example: <div class="fragment"><div class="line"><a class="code hl_struct" href="structpsa__key__derivation__s.html">psa_key_derivation_operation_t</a> operation;</div>
<div class="line">memset(&amp;operation, 0, <span class="keyword">sizeof</span>(operation));</div>
<div class="ttc" id="astructpsa__key__derivation__s_html"><div class="ttname"><a href="structpsa__key__derivation__s.html">psa_key_derivation_s</a></div><div class="ttdef"><b>Definition:</b> <a href="crypto__struct_8h_source.html#l00265">crypto_struct.h:266</a></div></div>
</div><!-- fragment --></li>
<li>Initialize the structure to logical zero values, for example: <div class="fragment"><div class="line"><a class="code hl_struct" href="structpsa__key__derivation__s.html">psa_key_derivation_operation_t</a> operation = {0};</div>
</div><!-- fragment --></li>
<li>Initialize the structure to the initializer <a class="el" href="group__key__derivation.html#ga5bdec40d201551558579a635520ae85d" title="This macro returns a suitable initializer for a key derivation operation object of type psa_key_deriv...">PSA_KEY_DERIVATION_OPERATION_INIT</a>, for example: <div class="fragment"><div class="line"><a class="code hl_struct" href="structpsa__key__derivation__s.html">psa_key_derivation_operation_t</a> operation = <a class="code hl_define" href="group__key__derivation.html#ga5bdec40d201551558579a635520ae85d">PSA_KEY_DERIVATION_OPERATION_INIT</a>;</div>
<div class="ttc" id="agroup__key__derivation_html_ga5bdec40d201551558579a635520ae85d"><div class="ttname"><a href="group__key__derivation.html#ga5bdec40d201551558579a635520ae85d">PSA_KEY_DERIVATION_OPERATION_INIT</a></div><div class="ttdeci">#define PSA_KEY_DERIVATION_OPERATION_INIT</div><div class="ttdoc">This macro returns a suitable initializer for a key derivation operation object of type psa_key_deriv...</div><div class="ttdef"><b>Definition:</b> <a href="crypto__struct_8h_source.html#l00282">crypto_struct.h:282</a></div></div>
</div><!-- fragment --></li>
<li>Assign the result of the function psa_key_derivation_operation_init() to the structure, for example: <div class="fragment"><div class="line"><a class="code hl_struct" href="structpsa__key__derivation__s.html">psa_key_derivation_operation_t</a> operation;</div>
<div class="line">operation = psa_key_derivation_operation_init();</div>
</div><!-- fragment --></li>
</ul>
<p >This is an implementation-defined <code>struct</code>. Applications should not make any assumptions about the content of this structure except as directed by the documentation of a specific implementation. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l03046">3046</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gac0b6a76e45cceb1862752bf041701859" name="gac0b6a76e45cceb1862752bf041701859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac0b6a76e45cceb1862752bf041701859">&#9670;&#160;</a></span>psa_key_derivation_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a>&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a key derivation operation. </p>
<p >A key derivation algorithm takes some inputs and uses them to generate a byte stream in a deterministic way. This byte stream can be used to produce keys and other cryptographic material.</p>
<p >To derive a key:</p><ol type="1">
<li>Start with an initialized object of type <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609" title="The type of the state data structure for key derivation operations.">psa_key_derivation_operation_t</a>.</li>
<li>Call <a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859" title="Set up a key derivation operation.">psa_key_derivation_setup()</a> to select the algorithm.</li>
<li>Provide the inputs for the key derivation by calling <a class="el" href="group__key__derivation.html#ga8fd934dfb0ca45cbf89542ef2a5494c2" title="Provide an input for key derivation or key agreement.">psa_key_derivation_input_bytes()</a> or <a class="el" href="group__key__derivation.html#gab2d7ce8705dd8e4a093f4b8a21a0c15a" title="Provide an input for key derivation in the form of a key.">psa_key_derivation_input_key()</a> as appropriate. Which inputs are needed, in what order, and whether they may be keys and if so of what type depends on the algorithm.</li>
<li>Optionally set the operation's maximum capacity with <a class="el" href="group__key__derivation.html#ga8c26178dc8e4581cb9fbce5650db3279" title="Set the maximum capacity of a key derivation operation.">psa_key_derivation_set_capacity()</a>. You may do this before, in the middle of or after providing inputs. For some algorithms, this step is mandatory because the output depends on the maximum capacity.</li>
<li>To derive a key, call <a class="el" href="group__key__derivation.html#gada7a6e17222ea9e7a6be6864a00316e1" title="Derive a key from an ongoing key derivation operation.">psa_key_derivation_output_key()</a>. To derive a byte string for a different purpose, call <a class="el" href="group__key__derivation.html#ga06b7eb34a2fa88965f68e3d023fa12b9" title="Read some data from a key derivation operation.">psa_key_derivation_output_bytes()</a>. Successive calls to these functions use successive output bytes calculated by the key derivation algorithm.</li>
<li>Clean up the key derivation operation object with <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</li>
</ol>
<p >If this function returns an error, the key derivation operation object is not changed.</p>
<p >If an error occurs at any step after a call to <a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859" title="Set up a key derivation operation.">psa_key_derivation_setup()</a>, the operation will need to be reset by a call to <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</p>
<p >Implementations must reject an attempt to derive a key of size 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to set up. It must have been initialized but not set up yet. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The key derivation algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#gaf8b90c648aa53dbd06c236695e300cd0" title="Whether the specified algorithm is a key derivation algorithm.">PSA_ALG_IS_KEY_DERIVATION</a>(<code>alg</code>) is true).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>alg</code> is not a key derivation algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation.">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not a key derivation algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be inactive). Or, alternately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9b0b6769491b25e0592fce0f1c96f842" name="ga9b0b6769491b25e0592fce0f1c96f842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9b0b6769491b25e0592fce0f1c96f842">&#9670;&#160;</a></span>psa_key_derivation_get_capacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_get_capacity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the current capacity of a key derivation operation. </p>
<p >The capacity of a key derivation is the maximum number of bytes that it can return. When you get <em>N</em> bytes of output from a key derivation operation, this reduces its capacity by <em>N</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">operation</td><td>The operation to query. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">capacity</td><td>On success, the capacity of the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active). Or, alterately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8c26178dc8e4581cb9fbce5650db3279" name="ga8c26178dc8e4581cb9fbce5650db3279"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c26178dc8e4581cb9fbce5650db3279">&#9670;&#160;</a></span>psa_key_derivation_set_capacity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_set_capacity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the maximum capacity of a key derivation operation. </p>
<p >The capacity of a key derivation operation is the maximum number of bytes that the key derivation operation can return from this point onwards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to modify. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">capacity</td><td>The new capacity of the operation. It must be less or equal to the operation's current capacity.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>capacity</code> is larger than the operation's current capacity. In this case, the operation object remains valid and its capacity remains unchanged. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active). Or, alternately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8fd934dfb0ca45cbf89542ef2a5494c2" name="ga8fd934dfb0ca45cbf89542ef2a5494c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8fd934dfb0ca45cbf89542ef2a5494c2">&#9670;&#160;</a></span>psa_key_derivation_input_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_input_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide an input for key derivation or key agreement. </p>
<p >Which inputs are required and in what order depends on the algorithm. Refer to the documentation of each key derivation or key agreement algorithm for information.</p>
<p >This function passes direct inputs, which is usually correct for non-secret inputs. To pass a secret input, which should be in a key object, call <a class="el" href="group__key__derivation.html#gab2d7ce8705dd8e4a093f4b8a21a0c15a" title="Provide an input for key derivation in the form of a key.">psa_key_derivation_input_key()</a> instead of this function. Refer to the documentation of individual step types (<code>PSA_KEY_DERIVATION_INPUT_xxx</code> values of type <a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b" title="Encoding of the step of a key derivation.">psa_key_derivation_step_t</a>) for more information.</p>
<p >If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859" title="Set up a key derivation operation.">psa_key_derivation_setup()</a> and must not have produced any output yet. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Input data to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_length</td><td>Size of the <code>data</code> buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>step</code> is not compatible with the operation's algorithm, or or <code>step</code> does not allow direct inputs. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid for this input <code>step</code>. Or, alterately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab2d7ce8705dd8e4a093f4b8a21a0c15a" name="gab2d7ce8705dd8e4a093f4b8a21a0c15a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab2d7ce8705dd8e4a093f4b8a21a0c15a">&#9670;&#160;</a></span>psa_key_derivation_input_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_input_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a>&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provide an input for key derivation in the form of a key. </p>
<p >Which inputs are required and in what order depends on the algorithm. Refer to the documentation of each key derivation or key agreement algorithm for information.</p>
<p >This function obtains input from a key object, which is usually correct for secret inputs or for non-secret personalization strings kept in the key store. To pass a non-secret parameter which is not in the key store, call <a class="el" href="group__key__derivation.html#ga8fd934dfb0ca45cbf89542ef2a5494c2" title="Provide an input for key derivation or key agreement.">psa_key_derivation_input_bytes()</a> instead of this function. Refer to the documentation of individual step types (<code>PSA_KEY_DERIVATION_INPUT_xxx</code> values of type <a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b" title="Encoding of the step of a key derivation.">psa_key_derivation_step_t</a>) for more information.</p>
<p >If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859" title="Set up a key derivation operation.">psa_key_derivation_setup()</a> and must not have produced any output yet. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key. It must have an appropriate type for step and must allow the usage <a class="el" href="group__policy.html#gaf19022acc5ef23cf12477f632b48a0b2" title="Whether the key may be used to derive other keys.">PSA_KEY_USAGE_DERIVE</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key identifier is not valid.">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy.">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>step</code> is not compatible with the operation's algorithm, or <code>step</code> does not allow key inputs of the given type or does not allow key inputs at all. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid for this input <code>step</code>. Or, alternately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2cd5a8ac906747d3204ec442db78745f" name="ga2cd5a8ac906747d3204ec442db78745f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2cd5a8ac906747d3204ec442db78745f">&#9670;&#160;</a></span>psa_key_derivation_key_agreement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_key_agreement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__derivation.html#gaac4eeacd36596c548b3a48fc06c5048b">psa_key_derivation_step_t</a>&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>peer_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>peer_key_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a key agreement and use the shared secret as input to a key derivation. </p>
<p >A key agreement algorithm takes two inputs: a private key <code>private_key</code> a public key <code>peer_key</code>. The result of this function is passed as input to a key derivation. The output of this key derivation can be extracted by reading from the resulting operation to produce keys and other cryptographic material.</p>
<p >If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to use. It must have been set up with <a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859" title="Set up a key derivation operation.">psa_key_derivation_setup()</a> with a key agreement and derivation algorithm <code>alg</code> (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga59753742cb06553bd22751bbef472b6f" title="Whether the specified algorithm is a key agreement algorithm.">PSA_ALG_IS_KEY_AGREEMENT</a>(<code>alg</code>) is true and <a class="el" href="group__crypto__types.html#gaa40ab362ce141ce541d69b2eb1f41438" title="Whether the specified algorithm is a raw key agreement algorithm.">PSA_ALG_IS_RAW_KEY_AGREEMENT</a>(<code>alg</code>) is false). The operation must be ready for an input of the type given by <code>step</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">step</td><td>Which step the input data is for. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">private_key</td><td>Identifier of the private key to use. It must allow the usage <a class="el" href="group__policy.html#gaf19022acc5ef23cf12477f632b48a0b2" title="Whether the key may be used to derive other keys.">PSA_KEY_USAGE_DERIVE</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">peer_key</td><td>Public key of the peer. The peer key must be in the same format that <a class="el" href="group__import__export.html#ga0336ea76bf30587ab204a8296462327b" title="Import a key in binary format.">psa_import_key()</a> accepts for the public key type corresponding to the type of private_key. That is, this function performs the equivalent of <a class="el" href="group__import__export.html#ga0336ea76bf30587ab204a8296462327b" title="Import a key in binary format.">psa_import_key</a>(..., <code>peer_key</code>, <code>peer_key_length</code>) where with key attributes indicating the public key type corresponding to the type of <code>private_key</code>. For example, for EC keys, this means that peer_key is interpreted as a point on the curve that the private key is on. The standard formats for public keys are documented in the documentation of <a class="el" href="group__import__export.html#gaf22ae73312217aaede2ea02cdebb6062" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">peer_key_length</td><td>Size of <code>peer_key</code> in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid for this key agreement <code>step</code>. Or, alternately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key identifier is not valid.">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy.">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>private_key</code> is not compatible with <code>alg</code>, or <code>step</code> does not allow an input resulting from a key agreement, or <code>peer_key</code> is not valid for <code>alg</code> or not compatible with <code>private_key</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation.">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not a key derivation algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga06b7eb34a2fa88965f68e3d023fa12b9" name="ga06b7eb34a2fa88965f68e3d023fa12b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06b7eb34a2fa88965f68e3d023fa12b9">&#9670;&#160;</a></span>psa_key_derivation_output_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_output_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read some data from a key derivation operation. </p>
<p >This function calculates output bytes from a key derivation algorithm and return those bytes. If you view the key derivation's output as a stream of bytes, this function destructively reads the requested number of bytes from the stream. The operation's capacity decreases by the number of bytes read.</p>
<p >If this function returns an error status other than <a class="el" href="group__error.html#ga086ac09f3a555f86e7997beb186f5eef" title="Return this error when there&#39;s insufficient data when attempting to read from a resource.">PSA_ERROR_INSUFFICIENT_DATA</a>, the operation enters an error state and must be aborted by calling <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to read from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Buffer where the output will be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">output_length</td><td>Number of bytes to output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga086ac09f3a555f86e7997beb186f5eef" title="Return this error when there&#39;s insufficient data when attempting to read from a resource.">PSA_ERROR_INSUFFICIENT_DATA</a></td><td>The operation's capacity was less than <code>output_length</code> bytes. Note that in this case, no output is written to the output buffer. The operation's capacity is set to 0, thus subsequent calls to this function will not succeed, even with a smaller output buffer. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active and completed all required input steps). Or, alternately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gada7a6e17222ea9e7a6be6864a00316e1" name="gada7a6e17222ea9e7a6be6864a00316e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada7a6e17222ea9e7a6be6864a00316e1">&#9670;&#160;</a></span>psa_key_derivation_output_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_output_key </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__attributes.html#ga0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *&#160;</td>
          <td class="paramname"><em>attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Derive a key from an ongoing key derivation operation. </p>
<p >This function calculates output bytes from a key derivation algorithm and uses those bytes to generate a key deterministically. The key's location, usage policy, type and size are taken from <code>attributes</code>.</p>
<p >If you view the key derivation's output as a stream of bytes, this function destructively reads as many bytes as required from the stream. The operation's capacity decreases by the number of bytes read.</p>
<p >If this function returns an error status other than <a class="el" href="group__error.html#ga086ac09f3a555f86e7997beb186f5eef" title="Return this error when there&#39;s insufficient data when attempting to read from a resource.">PSA_ERROR_INSUFFICIENT_DATA</a>, the operation enters an error state and must be aborted by calling <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a>.</p>
<p >How much output is produced and consumed from the operation, and how the key is derived, depends on the key type:</p>
<ul>
<li>For key types for which the key is an arbitrary sequence of bytes of a given size, this function is functionally equivalent to calling <a class="el" href="group__key__derivation.html#ga06b7eb34a2fa88965f68e3d023fa12b9" title="Read some data from a key derivation operation.">psa_key_derivation_output_bytes</a> and passing the resulting output to <a class="el" href="group__import__export.html#ga0336ea76bf30587ab204a8296462327b" title="Import a key in binary format.">psa_import_key</a>. However, this function has a security benefit: if the implementation provides an isolation boundary then the key material is not exposed outside the isolation boundary. As a consequence, for these key types, this function always consumes exactly (<code>bits</code> / 8) bytes from the operation. The following key types defined in this specification follow this scheme:<ul>
<li><a class="el" href="group__crypto__types.html#ga6ee54579dcf278c677eda4bb1a29575e" title="Key for a cipher, AEAD or MAC algorithm based on the AES block cipher.">PSA_KEY_TYPE_AES</a>;</li>
<li><a class="el" href="group__crypto__types.html#gae4d46e83f910dcaa126000a8ed03cde9" title="Key for the RC4 stream cipher.">PSA_KEY_TYPE_ARC4</a>;</li>
<li><a class="el" href="group__crypto__types.html#gad8e5da742343fd5519f9d8a630c2ed81" title="Key for a cipher, AEAD or MAC algorithm based on the Camellia block cipher.">PSA_KEY_TYPE_CAMELLIA</a>;</li>
<li><a class="el" href="group__crypto__types.html#gae871b2357b8593f33bfd51abbf93ebb1" title="A secret for key derivation.">PSA_KEY_TYPE_DERIVE</a>;</li>
<li><a class="el" href="group__crypto__types.html#ga92d989f4ca64abd00f463defd773a6f8" title="HMAC key.">PSA_KEY_TYPE_HMAC</a>.</li>
</ul>
</li>
<li>For ECC keys on a Montgomery elliptic curve (<a class="el" href="group__crypto__types.html#ga0b6f5d4d5037c54ffa850d8059c32df0" title="Elliptic curve key pair.">PSA_KEY_TYPE_ECC_KEY_PAIR</a>(<code>curve</code>) where <code>curve</code> designates a Montgomery curve), this function always draws a byte string whose length is determined by the curve, and sets the mandatory bits accordingly. That is:<ul>
<li>Curve25519 (<a class="el" href="group__crypto__types.html#ga1f624c5cdaf25b21287af33024e1aff8" title="Curve25519 and Curve448.">PSA_ECC_FAMILY_MONTGOMERY</a>, 255 bits): draw a 32-byte string and process it as specified in RFC 7748 &sect;5.</li>
<li>Curve448 (<a class="el" href="group__crypto__types.html#ga1f624c5cdaf25b21287af33024e1aff8" title="Curve25519 and Curve448.">PSA_ECC_FAMILY_MONTGOMERY</a>, 448 bits): draw a 56-byte string and process it as specified in RFC 7748 &sect;5.</li>
</ul>
</li>
<li>For key types for which the key is represented by a single sequence of <code>bits</code> bits with constraints as to which bit sequences are acceptable, this function draws a byte string of length (<code>bits</code> / 8) bytes rounded up to the nearest whole number of bytes. If the resulting byte string is acceptable, it becomes the key, otherwise the drawn bytes are discarded. This process is repeated until an acceptable byte string is drawn. The byte string drawn from the operation is interpreted as specified for the output produced by <a class="el" href="group__import__export.html#ga668e35be8d2852ad3feeef74ac6f75bf" title="Export a key in binary format.">psa_export_key()</a>. The following key types defined in this specification follow this scheme:<ul>
<li><a class="el" href="group__crypto__types.html#ga577562bfbbc691c820d55ec308333138" title="Key for a cipher or MAC algorithm based on DES or 3DES (Triple-DES).">PSA_KEY_TYPE_DES</a>. Force-set the parity bits, but discard forbidden weak keys. For 2-key and 3-key triple-DES, the three keys are generated successively (for example, for 3-key triple-DES, if the first 8 bytes specify a weak key and the next 8 bytes do not, discard the first 8 bytes, use the next 8 bytes as the first key, and continue reading output from the operation to derive the other two keys).</li>
<li>Finite-field Diffie-Hellman keys (<a class="el" href="group__crypto__types.html#gab4f857c4cd56f5fe65ded421e61bcc8c" title="Diffie-Hellman key pair.">PSA_KEY_TYPE_DH_KEY_PAIR</a>(<code>group</code>) where <code>group</code> designates any Diffie-Hellman group) and ECC keys on a Weierstrass elliptic curve (<a class="el" href="group__crypto__types.html#ga0b6f5d4d5037c54ffa850d8059c32df0" title="Elliptic curve key pair.">PSA_KEY_TYPE_ECC_KEY_PAIR</a>(<code>curve</code>) where <code>curve</code> designates a Weierstrass curve). For these key types, interpret the byte string as integer in big-endian order. Discard it if it is not in the range [0, <em>N</em> - 2] where <em>N</em> is the boundary of the private key domain (the prime <em>p</em> for Diffie-Hellman, the subprime <em>q</em> for DSA, or the order of the curve's base point for ECC). Add 1 to the resulting integer and use this as the private key <em>x</em>. This method allows compliance to NIST standards, specifically the methods titled "key-pair generation by testing candidates" in NIST SP 800-56A &sect;5.6.1.1.4 for Diffie-Hellman, in FIPS 186-4 &sect;B.1.2 for DSA, and in NIST SP 800-56A &sect;5.6.1.2.2 or FIPS 186-4 &sect;B.4.2 for elliptic curve keys.</li>
</ul>
</li>
<li>For other key types, including <a class="el" href="group__crypto__types.html#ga11745b110166e927e2abeabc7d532051" title="RSA key pair (private and public key).">PSA_KEY_TYPE_RSA_KEY_PAIR</a>, the way in which the operation output is consumed is implementation-defined.</li>
</ul>
<p >In all cases, the data that is read is discarded from the operation. The operation's capacity is decreased by the number of bytes read.</p>
<p >For algorithms that take an input step <a class="el" href="group__derivation.html#ga0ddfbe764baba995c402b1b0ef59392e" title="A secret input for key derivation.">PSA_KEY_DERIVATION_INPUT_SECRET</a>, the input to that step must be provided with <a class="el" href="group__key__derivation.html#gab2d7ce8705dd8e4a093f4b8a21a0c15a" title="Provide an input for key derivation in the form of a key.">psa_key_derivation_input_key()</a>. Future versions of this specification may include additional restrictions on the derived key based on the attributes and strength of the secret key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">attributes</td><td>The attributes for the new key. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The key derivation operation object to read from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>On success, an identifier for the newly created key. For persistent keys, this is the key identifier defined in <code>attributes</code>. <code>0</code> on failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>Success. If the key is persistent, the key material and the key's metadata have been saved to persistent storage. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gaf2b34cc87edc72f3ba90071a08210d20" title="Asking for an item that already exists.">PSA_ERROR_ALREADY_EXISTS</a></td><td>This is an attempt to create a persistent key, and there is already a persistent key with the given identifier. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga086ac09f3a555f86e7997beb186f5eef" title="Return this error when there&#39;s insufficient data when attempting to read from a resource.">PSA_ERROR_INSUFFICIENT_DATA</a></td><td>There was not enough data to create the desired key. Note that in this case, no output is written to the output buffer. The operation's capacity is set to 0, thus subsequent calls to this function will not succeed, even with a smaller output buffer. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation.">PSA_ERROR_NOT_SUPPORTED</a></td><td>The key type or key size is not supported, either by the implementation in general or in this particular location. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The provided key attributes are not valid for the operation. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy.">PSA_ERROR_NOT_PERMITTED</a></td><td>The <a class="el" href="group__derivation.html#ga0ddfbe764baba995c402b1b0ef59392e" title="A secret input for key derivation.">PSA_KEY_DERIVATION_INPUT_SECRET</a> input was not provided through a key. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active and completed all required input steps). Or, alternately, the library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga897a45eb206a6f6b7be7ffbe36f0d766" title="There is not enough persistent storage.">PSA_ERROR_INSUFFICIENT_STORAGE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga90fdd2716124d0bd258826184824675f" name="ga90fdd2716124d0bd258826184824675f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga90fdd2716124d0bd258826184824675f">&#9670;&#160;</a></span>psa_key_derivation_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_key_derivation_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609">psa_key_derivation_operation_t</a> *&#160;</td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort a key derivation operation. </p>
<p >Aborting an operation frees all associated resources except for the <code>operation</code> structure itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="group__key__derivation.html#gac0b6a76e45cceb1862752bf041701859" title="Set up a key derivation operation.">psa_key_derivation_setup()</a> again.</p>
<p >This function may be called at any time after the operation object has been initialized as described in <a class="el" href="group__key__derivation.html#ga5f099b63799a0959c3d46718c86c2609" title="The type of the state data structure for key derivation operations.">psa_key_derivation_operation_t</a>.</p>
<p >In particular, it is valid to call <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a> twice, or to call <a class="el" href="group__key__derivation.html#ga90fdd2716124d0bd258826184824675f" title="Abort a key derivation operation.">psa_key_derivation_abort()</a> on an operation that has not been set up.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The operation to abort.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga165dda1ad80a10730cb538069d4cc7aa" name="ga165dda1ad80a10730cb538069d4cc7aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga165dda1ad80a10730cb538069d4cc7aa">&#9670;&#160;</a></span>psa_raw_key_agreement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_raw_key_agreement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a>&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__key__lifetimes.html#ga9a5375bd0cb9694f3a2694adc0a6ae13">mbedtls_svc_key_id_t</a>&#160;</td>
          <td class="paramname"><em>private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>peer_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>peer_key_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a key agreement and return the raw shared secret. </p>
<dl class="section warning"><dt>Warning</dt><dd>The raw result of a key agreement algorithm such as finite-field Diffie-Hellman or elliptic curve Diffie-Hellman has biases and should not be used directly as key material. It should instead be passed as input to a key derivation algorithm. To chain a key agreement with a key derivation, use <a class="el" href="group__key__derivation.html#ga2cd5a8ac906747d3204ec442db78745f" title="Perform a key agreement and use the shared secret as input to a key derivation.">psa_key_derivation_key_agreement()</a> and other functions from the key derivation interface.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The key agreement algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#gaa40ab362ce141ce541d69b2eb1f41438" title="Whether the specified algorithm is a raw key agreement algorithm.">PSA_ALG_IS_RAW_KEY_AGREEMENT</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">private_key</td><td>Identifier of the private key to use. It must allow the usage <a class="el" href="group__policy.html#gaf19022acc5ef23cf12477f632b48a0b2" title="Whether the key may be used to derive other keys.">PSA_KEY_USAGE_DERIVE</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">peer_key</td><td>Public key of the peer. It must be in the same format that <a class="el" href="group__import__export.html#ga0336ea76bf30587ab204a8296462327b" title="Import a key in binary format.">psa_import_key()</a> accepts. The standard formats for public keys are documented in the documentation of <a class="el" href="group__import__export.html#gaf22ae73312217aaede2ea02cdebb6062" title="Export a public key or the public part of a key pair in binary format.">psa_export_public_key()</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">peer_key_length</td><td>Size of <code>peer_key</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Buffer where the decrypted message is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">output_size</td><td>Size of the <code>output</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key identifier is not valid.">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy.">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>alg</code> is not a key agreement algorithm, or <code>private_key</code> is not compatible with <code>alg</code>, or <code>peer_key</code> is not valid for <code>alg</code> or not compatible with <code>private_key</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small.">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>output_size</code> is too small </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation.">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not a supported key agreement algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory.">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation.">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected.">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected.">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state.">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
