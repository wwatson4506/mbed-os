<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed OS Reference: crypto_extra.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mbed-ce_55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">Mbed OS Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('crypto__extra_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">crypto_extra.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>PSA cryptography module: Mbed TLS vendor extensions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="platform__util_8h_source.html">mbedtls/platform_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__compat_8h_source.html">crypto_compat.h</a>&quot;</code><br />
</div>
<p><a href="crypto__extra_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statistics about resource consumption related to the PSA keystore.  <a href="structmbedtls__psa__stats__s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa406d8c915ddb507f10f6f14fcf89da8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__extra_8h.html#aa406d8c915ddb507f10f6f14fcf89da8">PSA_CRYPTO_ITS_RANDOM_SEED_UID</a>&#160;&#160;&#160;0xFFFFFF52</td></tr>
<tr class="memdesc:aa406d8c915ddb507f10f6f14fcf89da8"><td class="mdescLeft">&#160;</td><td class="mdescRight">UID for secure storage seed.  <a href="crypto__extra_8h.html#aa406d8c915ddb507f10f6f14fcf89da8">More...</a><br /></td></tr>
<tr class="separator:aa406d8c915ddb507f10f6f14fcf89da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e7439c2905136366c3a876e62e5ddfc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__types.html#ga5e7439c2905136366c3a876e62e5ddfc">PSA_KEY_TYPE_DSA_PUBLIC_KEY</a>&#160;&#160;&#160;((<a class="el" href="group__crypto__types.html#ga63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a>)0x4002)</td></tr>
<tr class="memdesc:ga5e7439c2905136366c3a876e62e5ddfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">DSA public key.  <a href="group__crypto__types.html#ga5e7439c2905136366c3a876e62e5ddfc">More...</a><br /></td></tr>
<tr class="separator:ga5e7439c2905136366c3a876e62e5ddfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d4a45c147cb0ecb55d01d9c04bfed76"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__types.html#ga7d4a45c147cb0ecb55d01d9c04bfed76">PSA_KEY_TYPE_DSA_KEY_PAIR</a>&#160;&#160;&#160;((<a class="el" href="group__crypto__types.html#ga63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a>)0x7002)</td></tr>
<tr class="memdesc:ga7d4a45c147cb0ecb55d01d9c04bfed76"><td class="mdescLeft">&#160;</td><td class="mdescRight">DSA key pair (private and public key).  <a href="group__crypto__types.html#ga7d4a45c147cb0ecb55d01d9c04bfed76">More...</a><br /></td></tr>
<tr class="separator:ga7d4a45c147cb0ecb55d01d9c04bfed76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga273fdfcf23eb0624f8b63d2321cf95c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__types.html#ga273fdfcf23eb0624f8b63d2321cf95c1">PSA_KEY_TYPE_IS_DSA</a>(type)&#160;&#160;&#160;    (<a class="el" href="group__crypto__types.html#ga679be3d789cfa0c1fd8418764ff754b1">PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR</a>(type) == <a class="el" href="group__crypto__types.html#ga5e7439c2905136366c3a876e62e5ddfc">PSA_KEY_TYPE_DSA_PUBLIC_KEY</a>)</td></tr>
<tr class="memdesc:ga273fdfcf23eb0624f8b63d2321cf95c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether a key type is an DSA key (pair or public-only).  <a href="group__crypto__types.html#ga273fdfcf23eb0624f8b63d2321cf95c1">More...</a><br /></td></tr>
<tr class="separator:ga273fdfcf23eb0624f8b63d2321cf95c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a68efdddff5ae95f104a1416b12742e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__types.html#ga9a68efdddff5ae95f104a1416b12742e">PSA_ALG_DSA</a>(hash_alg)&#160;&#160;&#160;    (PSA_ALG_DSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</td></tr>
<tr class="memdesc:ga9a68efdddff5ae95f104a1416b12742e"><td class="mdescLeft">&#160;</td><td class="mdescRight">DSA signature with hashing.  <a href="group__crypto__types.html#ga9a68efdddff5ae95f104a1416b12742e">More...</a><br /></td></tr>
<tr class="separator:ga9a68efdddff5ae95f104a1416b12742e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab8eb98fb6d2e094e47f3b44dfe128f94"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__types.html#gab8eb98fb6d2e094e47f3b44dfe128f94">PSA_ALG_DETERMINISTIC_DSA</a>(hash_alg)&#160;&#160;&#160;    (PSA_ALG_DETERMINISTIC_DSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</td></tr>
<tr class="memdesc:gab8eb98fb6d2e094e47f3b44dfe128f94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deterministic DSA signature with hashing.  <a href="group__crypto__types.html#gab8eb98fb6d2e094e47f3b44dfe128f94">More...</a><br /></td></tr>
<tr class="separator:gab8eb98fb6d2e094e47f3b44dfe128f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab930304ccac92e0729fb5535c87a9fc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__attributes.html#gab930304ccac92e0729fb5535c87a9fc2">PSA_DH_FAMILY_CUSTOM</a>&#160;&#160;&#160;((<a class="el" href="group__crypto__types.html#gaf632c5b13aa19c98f8591d4beda8dd1a">psa_dh_family_t</a>) 0x7e)</td></tr>
<tr class="memdesc:gab930304ccac92e0729fb5535c87a9fc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Custom Diffie-Hellman group.  <a href="group__attributes.html#gab930304ccac92e0729fb5535c87a9fc2">More...</a><br /></td></tr>
<tr class="separator:gab930304ccac92e0729fb5535c87a9fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59089e39970e89191105bd3b3294c3bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__attributes.html#ga59089e39970e89191105bd3b3294c3bd">PSA_KEY_DOMAIN_PARAMETERS_SIZE</a>(key_type,  key_bits)</td></tr>
<tr class="memdesc:ga59089e39970e89191105bd3b3294c3bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Safe output buffer size for <a class="el" href="group__attributes.html#gae42b480d8ffa161eb2a0a3e391010347" title="Get domain parameters for a key.">psa_get_key_domain_parameters()</a>.  <a href="group__attributes.html#ga59089e39970e89191105bd3b3294c3bd">More...</a><br /></td></tr>
<tr class="separator:ga59089e39970e89191105bd3b3294c3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aa9b95eb371f975f041d50f1a662357fe"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">mbedtls_psa_stats_t</a></td></tr>
<tr class="memdesc:aa9b95eb371f975f041d50f1a662357fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statistics about resource consumption related to the PSA keystore.  <a href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">More...</a><br /></td></tr>
<tr class="separator:aa9b95eb371f975f041d50f1a662357fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a00f4837e0253580c83b4d93ea91aa48b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__extra_8h.html#a00f4837e0253580c83b4d93ea91aa48b">mbedtls_psa_crypto_free</a> (void)</td></tr>
<tr class="memdesc:a00f4837e0253580c83b4d93ea91aa48b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Library deinitialization.  <a href="crypto__extra_8h.html#a00f4837e0253580c83b4d93ea91aa48b">More...</a><br /></td></tr>
<tr class="separator:a00f4837e0253580c83b4d93ea91aa48b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4d160ae9c02a60317702832a828e4b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__extra_8h.html#aa4d160ae9c02a60317702832a828e4b7">mbedtls_psa_get_stats</a> (<a class="el" href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">mbedtls_psa_stats_t</a> *stats)</td></tr>
<tr class="memdesc:aa4d160ae9c02a60317702832a828e4b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get statistics about resource consumption related to the PSA keystore.  <a href="crypto__extra_8h.html#aa4d160ae9c02a60317702832a828e4b7">More...</a><br /></td></tr>
<tr class="separator:aa4d160ae9c02a60317702832a828e4b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f09c8f08db9e2d881f465c432a300d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto__extra_8h.html#af4f09c8f08db9e2d881f465c432a300d">mbedtls_psa_inject_entropy</a> (const uint8_t *seed, size_t seed_size)</td></tr>
<tr class="memdesc:af4f09c8f08db9e2d881f465c432a300d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inject an initial entropy seed for the random generator into secure storage.  <a href="crypto__extra_8h.html#af4f09c8f08db9e2d881f465c432a300d">More...</a><br /></td></tr>
<tr class="separator:af4f09c8f08db9e2d881f465c432a300d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8909d3f2ee48121ea0dff198276bdd38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__attributes.html#ga8909d3f2ee48121ea0dff198276bdd38">psa_set_key_domain_parameters</a> (<a class="el" href="group__attributes.html#ga0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, <a class="el" href="group__crypto__types.html#ga63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a> type, const uint8_t *data, size_t data_length)</td></tr>
<tr class="memdesc:ga8909d3f2ee48121ea0dff198276bdd38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set domain parameters for a key.  <a href="group__attributes.html#ga8909d3f2ee48121ea0dff198276bdd38">More...</a><br /></td></tr>
<tr class="separator:ga8909d3f2ee48121ea0dff198276bdd38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae42b480d8ffa161eb2a0a3e391010347"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__attributes.html#gae42b480d8ffa161eb2a0a3e391010347">psa_get_key_domain_parameters</a> (const <a class="el" href="group__attributes.html#ga0ec645e1fdafe59d591104451ebf5680">psa_key_attributes_t</a> *attributes, uint8_t *data, size_t data_size, size_t *data_length)</td></tr>
<tr class="memdesc:gae42b480d8ffa161eb2a0a3e391010347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get domain parameters for a key.  <a href="group__attributes.html#gae42b480d8ffa161eb2a0a3e391010347">More...</a><br /></td></tr>
<tr class="separator:gae42b480d8ffa161eb2a0a3e391010347"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >PSA cryptography module: Mbed TLS vendor extensions. </p>
<dl class="section note"><dt>Note</dt><dd>This file may not be included directly. Applications must include <a class="el" href="crypto_8h.html" title="Platform Security Architecture cryptography module.">psa/crypto.h</a>.</dd></dl>
<p>This file is reserved for vendor-specific definitions. </p>

<p class="definition">Definition in file <a class="el" href="crypto__extra_8h_source.html">crypto_extra.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa406d8c915ddb507f10f6f14fcf89da8" name="aa406d8c915ddb507f10f6f14fcf89da8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa406d8c915ddb507f10f6f14fcf89da8">&#9670;&#160;</a></span>PSA_CRYPTO_ITS_RANDOM_SEED_UID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSA_CRYPTO_ITS_RANDOM_SEED_UID&#160;&#160;&#160;0xFFFFFF52</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UID for secure storage seed. </p>

<p class="definition">Definition at line <a class="el" href="crypto__extra_8h_source.html#l00040">40</a> of file <a class="el" href="crypto__extra_8h_source.html">crypto_extra.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aa9b95eb371f975f041d50f1a662357fe" name="aa9b95eb371f975f041d50f1a662357fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9b95eb371f975f041d50f1a662357fe">&#9670;&#160;</a></span>mbedtls_psa_stats_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a> <a class="el" href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">mbedtls_psa_stats_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Statistics about resource consumption related to the PSA keystore. </p>
<dl class="section note"><dt>Note</dt><dd>The content of this structure is not part of the stable API and ABI of Mbed Crypto and may change arbitrarily from version to version. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a00f4837e0253580c83b4d93ea91aa48b" name="a00f4837e0253580c83b4d93ea91aa48b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f4837e0253580c83b4d93ea91aa48b">&#9670;&#160;</a></span>mbedtls_psa_crypto_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_psa_crypto_free </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Library deinitialization. </p>
<p >This function clears all data associated with the PSA layer, including the whole key store.</p>
<p >This is an Mbed TLS extension. </p>

</div>
</div>
<a id="aa4d160ae9c02a60317702832a828e4b7" name="aa4d160ae9c02a60317702832a828e4b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4d160ae9c02a60317702832a828e4b7">&#9670;&#160;</a></span>mbedtls_psa_get_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_psa_get_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypto__extra_8h.html#aa9b95eb371f975f041d50f1a662357fe">mbedtls_psa_stats_t</a> *&#160;</td>
          <td class="paramname"><em>stats</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get statistics about resource consumption related to the PSA keystore. </p>
<dl class="section note"><dt>Note</dt><dd>When Mbed Crypto is built as part of a service, with isolation between the application and the keystore, the service may or may not expose this function. </dd></dl>

</div>
</div>
<a id="af4f09c8f08db9e2d881f465c432a300d" name="af4f09c8f08db9e2d881f465c432a300d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f09c8f08db9e2d881f465c432a300d">&#9670;&#160;</a></span>mbedtls_psa_inject_entropy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> mbedtls_psa_inject_entropy </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>seed_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inject an initial entropy seed for the random generator into secure storage. </p>
<p >This function injects data to be used as a seed for the random generator used by the PSA Crypto implementation. On devices that lack a trusted entropy source (preferably a hardware random number generator), the Mbed PSA Crypto implementation uses this value to seed its random generator.</p>
<p >On devices without a trusted entropy source, this function must be called exactly once in the lifetime of the device. On devices with a trusted entropy source, calling this function is optional. In all cases, this function may only be called before calling any other function in the PSA Crypto API, including <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a>.</p>
<p >When this function returns successfully, it populates a file in persistent storage. Once the file has been created, this function can no longer succeed.</p>
<p >If any error occurs, this function does not change the system state. You can call this function again after correcting the reason for the error if possible.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function <b>can</b> fail! Callers MUST check the return status.</dd>
<dd>
If you use this function, you should use it as part of a factory provisioning process. The value of the injected seed is critical to the security of the device. It must be <em>secret</em>, <em>unpredictable</em> and (statistically) <em>unique per device</em>. You should be generate it randomly using a cryptographically secure random generator seeded from trusted entropy sources. You should transmit it securely to the device and ensure that its value is not leaked or stored anywhere beyond the needs of transmitting it from the point of generation to the call of this function, and erase all copies of the value once this function returns.</dd></dl>
<p>This is an Mbed TLS extension.</p>
<dl class="section note"><dt>Note</dt><dd>This function is only available on the following platforms:<ul>
<li>If the compile-time option MBEDTLS_PSA_INJECT_ENTROPY is enabled. Note that you must provide compatible implementations of mbedtls_nv_seed_read and mbedtls_nv_seed_write.</li>
<li>In a client-server integration of PSA Cryptography, on the client side, if the server supports this feature. </li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>Buffer containing the seed value to inject. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seed_size</td><td>Size of the <code>seed</code> buffer. The size of the seed in bytes must be greater or equal to both <a class="el" href="group__mbedtls__entropy__module.html#ga7bd03568eb4ced60c878a6adc46aa407" title="Minimum for platform source">MBEDTLS_ENTROPY_MIN_PLATFORM</a> and <a class="el" href="group__mbedtls__entropy__module.html#gacc0fdb8c34a1ae04a81b4b21cb383941" title="Block size of entropy accumulator (SHA-256)">MBEDTLS_ENTROPY_BLOCK_SIZE</a>. It must be less or equal to <a class="el" href="group__mbedtls__entropy__module.html#gafff6ba3d7fc6df1fedd007d3a9a4136b" title="Maximum size of seed we read from seed file.">MBEDTLS_ENTROPY_MAX_SEED_SIZE</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully.">PSA_SUCCESS</a></td><td>The seed value was injected successfully. The random generator of the PSA Crypto implementation is now ready for use. You may now call <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization.">psa_crypto_init()</a> and use the PSA Crypto implementation. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid.">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>seed_size</code> is out of range. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss.">PSA_ERROR_STORAGE_FAILURE</a></td><td>There was a failure reading or writing from storage. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy.">PSA_ERROR_NOT_PERMITTED</a></td><td>The library has already been initialized. It is no longer possible to call this function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c5a52a81292cf9a5167198f4f346d6d9.html">platform</a></li><li class="navelem"><a class="el" href="dir_9f11e1863d28d29b770fc84ca939cb66.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_ec63b45c6c0fa38922a7f94cb2186efd.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_74d3a6236562fcf0e40f9690e0965875.html">TARGET_MBED_PSA_SRV</a></li><li class="navelem"><a class="el" href="dir_a3503c50d2d2fb809be1ba9078b1848e.html">inc</a></li><li class="navelem"><a class="el" href="dir_6fda2c4053325e07bf36bc18b0d53b0d.html">psa</a></li><li class="navelem"><a class="el" href="crypto__extra_8h.html">crypto_extra.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
