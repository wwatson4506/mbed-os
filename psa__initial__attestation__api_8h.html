<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed OS Reference: psa_initial_attestation_api.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mbed-ce_55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">Mbed OS Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('psa__initial__attestation__api_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">psa_initial_attestation_api.h File Reference<div class="ingroups"><a class="el" href="group__mbed-os-experimental.html">Experimental APIs</a> &raquo; <a class="el" href="group__experimental-crypto.html">Cryptography</a> &raquo; <a class="el" href="group__experimental-crypto-psa.html">Arm Platform Security Architecture (PSA)</a> &raquo; <a class="el" href="group___p_s_a-_attestation.html">PSA-Attestation</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The list of fixed claims in the initial attestation token is still evolving, you can expect slight changes in the future.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;limits.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div>
<p><a href="psa__initial__attestation__api_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga30b9410d79cbe04d47b5bae88e42d430"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#ga30b9410d79cbe04d47b5bae88e42d430">PSA_INITIAL_ATTEST_API_VERSION_MAJOR</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:ga30b9410d79cbe04d47b5bae88e42d430"><td class="mdescLeft">&#160;</td><td class="mdescRight">PSA INITIAL ATTESTATION API version.  <a href="group___p_s_a-_attestation.html#ga30b9410d79cbe04d47b5bae88e42d430">More...</a><br /></td></tr>
<tr class="separator:ga30b9410d79cbe04d47b5bae88e42d430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade81ef1dca5e261fc3f0e65bae31a063"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#gade81ef1dca5e261fc3f0e65bae31a063">PSA_INITIAL_ATTEST_CHALLENGE_SIZE_32</a>&#160;&#160;&#160;(32u)</td></tr>
<tr class="memdesc:gade81ef1dca5e261fc3f0e65bae31a063"><td class="mdescLeft">&#160;</td><td class="mdescRight">32 byte challenge  <a href="group___p_s_a-_attestation.html#gade81ef1dca5e261fc3f0e65bae31a063">More...</a><br /></td></tr>
<tr class="separator:gade81ef1dca5e261fc3f0e65bae31a063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19368a5153a32c67118ad94da01a007f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#ga19368a5153a32c67118ad94da01a007f">PSA_INITIAL_ATTEST_CHALLENGE_SIZE_48</a>&#160;&#160;&#160;(48u)</td></tr>
<tr class="memdesc:ga19368a5153a32c67118ad94da01a007f"><td class="mdescLeft">&#160;</td><td class="mdescRight">48 byte challenge  <a href="group___p_s_a-_attestation.html#ga19368a5153a32c67118ad94da01a007f">More...</a><br /></td></tr>
<tr class="separator:ga19368a5153a32c67118ad94da01a007f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7bcc59cd8e05583d290b91a1747a3e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#gaf7bcc59cd8e05583d290b91a1747a3e5">PSA_INITIAL_ATTEST_CHALLENGE_SIZE_64</a>&#160;&#160;&#160;(64u)</td></tr>
<tr class="memdesc:gaf7bcc59cd8e05583d290b91a1747a3e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">64 byte challenge  <a href="group___p_s_a-_attestation.html#gaf7bcc59cd8e05583d290b91a1747a3e5">More...</a><br /></td></tr>
<tr class="separator:gaf7bcc59cd8e05583d290b91a1747a3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gae224b55085979f76862a7afa8e8d75b2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#gae224b55085979f76862a7afa8e8d75b2">psa_attest_err_t</a> { <br />
&#160;&#160;<a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2ac5760809de7ca1362e1284aa2c0a555f">PSA_ATTEST_ERR_SUCCESS</a> = 0
, <a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2a5d1c7436d947cc0e27bc95b9bcb89e66">PSA_ATTEST_ERR_INIT_FAILED</a>
, <a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2a3f8ccaaa13d04d46ad7ffe44c99e1eaf">PSA_ATTEST_ERR_TOKEN_BUFFER_OVERFLOW</a>
, <a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2a5d6aa034be6547e95507f7f4fb6c2591">PSA_ATTEST_ERR_CLAIM_UNAVAILABLE</a>
, <br />
&#160;&#160;<a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2a04c6b0db3947865cdd518b7378049bc0">PSA_ATTEST_ERR_INVALID_INPUT</a>
, <a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2a1fed43d803a600c289c67c190e4dd1c9">PSA_ATTEST_ERR_GENERAL</a>
, <a class="el" href="group___p_s_a-_attestation.html#ggae224b55085979f76862a7afa8e8d75b2a00b43ba405eee4227a2839a1be3e0428">PSA_ATTEST_ERR_FORCE_INT_SIZE</a> = INT_MAX
<br />
 }</td></tr>
<tr class="memdesc:gae224b55085979f76862a7afa8e8d75b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial attestation service error types.  <a href="group___p_s_a-_attestation.html#gae224b55085979f76862a7afa8e8d75b2">More...</a><br /></td></tr>
<tr class="separator:gae224b55085979f76862a7afa8e8d75b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga540267cffd7e0ece3702b003bed54b6f"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group___p_s_a-_attestation.html#gae224b55085979f76862a7afa8e8d75b2">psa_attest_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#ga540267cffd7e0ece3702b003bed54b6f">psa_initial_attest_get_token</a> (const uint8_t *challenge_obj, uint32_t challenge_size, uint8_t *token, uint32_t *token_size)</td></tr>
<tr class="memdesc:ga540267cffd7e0ece3702b003bed54b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get initial attestation token.  <a href="group___p_s_a-_attestation.html#ga540267cffd7e0ece3702b003bed54b6f">More...</a><br /></td></tr>
<tr class="separator:ga540267cffd7e0ece3702b003bed54b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf86465814655a13369856694add6c09b"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="group___p_s_a-_attestation.html#gae224b55085979f76862a7afa8e8d75b2">psa_attest_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_s_a-_attestation.html#gaf86465814655a13369856694add6c09b">psa_initial_attest_get_token_size</a> (uint32_t challenge_size, uint32_t *token_size)</td></tr>
<tr class="memdesc:gaf86465814655a13369856694add6c09b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the exact size of initial attestation token in bytes.  <a href="group___p_s_a-_attestation.html#gaf86465814655a13369856694add6c09b">More...</a><br /></td></tr>
<tr class="separator:gaf86465814655a13369856694add6c09b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The list of fixed claims in the initial attestation token is still evolving, you can expect slight changes in the future. </p>
<p >The initial attestation token is planned to be aligned with future version of Entity Attestation Token format: <a href="https://tools.ietf.org/html/draft-mandyam-eat-01">https://tools.ietf.org/html/draft-mandyam-eat-01</a></p>
<p >Current list of claims: </p><ul>
<li>
<p class="startli"><b>Challenge:</b> Input object from caller. Can be a single nonce from server or hash of nonce and attested data. It is intended to provide freshness to reports and the caller has responsibility to arrange this. Allowed length: 32, 48, 64 bytes. The claim is modeled to be eventually represented by the EAT standard claim nonce. Until such a time as that standard exists, the claim will be represented by a custom claim. Value is encoded as byte string.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Instance</b> ID: It represents the unique identifier of the instance. In the PSA definition it is a hash of the public attestation key of the instance. The claim is modeled to be eventually represented by the EAT standard claim UEID of type GUID. Until such a time as that standard exists, the claim will be represented by a custom claim Value is encoded as byte string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Verification</b> service indicator: Optional, recommended claim. It is used by a Relying Party to locate a validation service for the token. The value is a text string that can be used to locate the service or a URL specifying the address of the service. The claim is modeled to be eventually represented by the EAT standard claim origination. Until such a time as that standard exists, the claim will be represented by a custom claim. Value is encoded as text string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Profile</b> definition: Optional, recommended claim. It contains the name of a document that describes the 'profile' of the token, being a full description of the claims, their usage, verification and token signing. The document name may include versioning. Custom claim with a value encoded as text string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Implementation</b> ID: It represents the original implementation signer of the attestation key and identifies the contract between the report and verification. A verification service will use this claim to locate the details of the verification process. Custom claim with a value encoded as byte string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Security</b> lifecycle: It represents the current lifecycle state of the instance. Custom claim with a value encoded as integer that is divided to convey a major state and a minor state. The PSA state and implementation state are encoded as follows: </p><ul>
<li>
version[15:8] - PSA lifecycle state - major  </li>
<li>
version[7:0] - IMPLEMENTATION DEFINED state - minor  </li>
</ul>
<p>Possible PSA lifecycle states: </p><ul>
<li>
Unknown (0x1000u)  </li>
<li>
PSA_RoT_Provisioning (0x2000u) </li>
<li>
Secured (0x3000u)  </li>
<li>
Non_PSA_RoT_Debug(0x4000u)  </li>
<li>
Recoverable_PSA_RoT_Debug (0x5000u)  </li>
<li>
Decommissioned (0x6000u)  </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Client</b> ID: The partition ID of that secure partition or non-secure thread who called the initial attestation API. Custom claim with a value encoded as a <em>signed</em> integer. Negative number represents non-secure caller, positive numbers represents secure callers, zero is invalid. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>HW</b> version: Optional claim. Globally unique number in EAN-13 format identifying the GDSII that went to fabrication, HW and ROM. It can be used to reference the security level of the PSA-ROT via a certification website. Custom claim with a value is encoded as text string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Boot</b> seed: It represents a random value created at system boot time that will allow differentiation of reports from different system sessions. The size is 32 bytes. Custom claim with a value is encoded as byte string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Software</b> components: Recommended claim. It represents the software state of the system. The value of the claim is an array of CBOR map entries, with one entry per software component within the device. Each map contains multiple claims that describe evidence about the details of the software component. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Measurement</b> type: Optional claim. It represents the role of the software component. Value is encoded as short(!) text string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Measurement</b> value: It represents a hash of the invariant software component in memory at start-up time. The value must be a cryptographic hash of 256 bits or stronger.Value is encoded as byte string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Security</b> epoch: Optional claim. It represents the security control point of the software component. Value is encoded as unsigned integer. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Version:</b> Optional claim. It represents the issued software version. Value is encoded as text string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Signer</b> ID: It represents the hash of a signing authority public key. Value is encoded as byte string. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Measurement</b> description: Optional claim. It represents the way in which the measurement value of the software component is computed. Value is encoded as text string containing an abbreviated description (name) of the measurement method. </p>
<p class="endli"></p>
</li>
<li>
<b>No</b> software measurements: In the event that the implementation does not contain any software measurements then the software components claim above can be omitted but instead it is mandatory to include this claim to indicate this is a deliberate state. Custom claim a value is encoded as unsigned integer set to 1.  </li>
</ul>

<p class="definition">Definition in file <a class="el" href="psa__initial__attestation__api_8h_source.html">psa_initial_attestation_api.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c5a52a81292cf9a5167198f4f346d6d9.html">platform</a></li><li class="navelem"><a class="el" href="dir_9f11e1863d28d29b770fc84ca939cb66.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_ec63b45c6c0fa38922a7f94cb2186efd.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_74d3a6236562fcf0e40f9690e0965875.html">TARGET_MBED_PSA_SRV</a></li><li class="navelem"><a class="el" href="dir_74b09220d5ec65c3949f80a8441eab30.html">services</a></li><li class="navelem"><a class="el" href="dir_43fbdd615e597b40be19919c0b4856f9.html">attestation</a></li><li class="navelem"><a class="el" href="psa__initial__attestation__api_8h.html">psa_initial_attestation_api.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
